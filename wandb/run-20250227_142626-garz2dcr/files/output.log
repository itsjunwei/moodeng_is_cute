GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA GeForce RTX 3060 Laptop GPU') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Loading `train_dataloader` to estimate number of stepping batches.
C:\Users\fenel\anaconda3\envs\d24_t1\lib\site-packages\pytorch_lightning\trainer\connectors\data_connector.py:424: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=15` in the `DataLoader` to improve performance.
C:\Users\fenel\anaconda3\envs\d24_t1\lib\site-packages\pytorch_lightning\loops\fit_loop.py:298: The number of training batches (28) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.
  | Name             | Type                    | Params | Mode
---------------------------------------------------------------------
0 | mel              | Sequential              | 0      | train
1 | mel_augment      | Sequential              | 0      | train
2 | model            | AcousticSceneClassifier | 4.2 M  | train
3 | device_embedding | Embedding               | 288    | train
4 | classifier       | Sequential              | 6.8 K  | train
---------------------------------------------------------------------
4.2 M     Trainable params
0         Non-trainable params
4.2 M     Total params
16.914    Total estimated model params size (MB)
29        Modules in train mode
0         Modules in eval mode
C:\Users\fenel\anaconda3\envs\d24_t1\lib\site-packages\pytorch_lightning\trainer\connectors\data_connector.py:424: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=15` in the `DataLoader` to improve performance.



























Epoch 0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [01:06<00:00,  0.42it/s, v_num=2dcr]


















































































































Validation DataLoader 0:  99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉ | 115/116 [04:48<00:02,  0.40it/s]

Testing: |                                                                                                                                                           | 0/? [00:00<?, ?it/s]
Restoring states from the checkpoint path at C:\Users\fenel\Documents\dcase2024_task1_baseline\DCASE24_Task1\garz2dcr\checkpoints\last.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Loaded model weights from the checkpoint at C:\Users\fenel\Documents\dcase2024_task1_baseline\DCASE24_Task1\garz2dcr\checkpoints\last.ckpt















































Testing DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 116/116 [01:35<00:00,  1.21it/s]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
        Test metric               DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
         test/acc              0.18867924809455872
        test/acc.a             0.22969697415828705
     test/acc.airport                  0.0
        test/acc.b             0.24012157320976257
       test/acc.bus          0.00033670032280497253
        test/acc.c             0.22431610524654388
      test/acc.metro           0.1047138050198555
  test/acc.metro_station               0.0
       test/acc.park           0.43030303716659546
  test/acc.public_square               0.0
       test/acc.real            0.231376513838768
        test/acc.s1            0.20545454323291779
        test/acc.s2            0.14575757086277008
        test/acc.s3            0.1775757521390915
        test/acc.s4            0.16484849154949188
        test/acc.s5            0.16484849154949188
        test/acc.s6            0.14575757086277008
       test/acc.seen           0.17626263201236725
  test/acc.shopping_mall       0.6164982914924622
test/acc.street_pedestrian             0.0
  test/acc.street_traffic      0.7282828092575073
       test/acc.tram          0.0054054055362939835
      test/acc.unseen          0.15848484635353088
        test/cnt.a                   3300.0
     test/cnt.airport                2960.0
        test/cnt.b                   3290.0
       test/cnt.bus                  2970.0
        test/cnt.c                   3290.0
      test/cnt.metro                 2970.0
  test/cnt.metro_station             2970.0
       test/cnt.park                 2970.0
  test/cnt.public_square             2970.0
        test/cnt.s1                  3300.0
        test/cnt.s2                  3300.0
        test/cnt.s3                  3300.0
        test/cnt.s4                  3300.0
        test/cnt.s5                  3300.0
        test/cnt.s6                  3300.0
  test/cnt.shopping_mall             2970.0
test/cnt.street_pedestrian           2970.0
  test/cnt.street_traffic            2970.0
       test/cnt.tram                 2960.0
      test/count.real                9880.0
      test/count.seen                9900.0
     test/count.unseen               9900.0
      test/lloss.real          2.1478805541992188
      test/lloss.seen          2.2645397186279297
     test/lloss.unseen         2.2894816398620605
         test/loss              2.234046697616577
        test/loss.a             2.131309747695923
     test/loss.airport         2.7291510105133057
        test/loss.b            2.1654324531555176
       test/loss.bus            2.712435722351074
        test/loss.c            2.1469504833221436
      test/loss.metro          2.0702202320098877
  test/loss.metro_station      2.1397957801818848
      test/loss.park            2.186511516571045
  test/loss.public_square       2.435145378112793
       test/loss.s1            2.2145330905914307
       test/loss.s2             2.324761390686035
       test/loss.s3            2.2543249130249023
       test/loss.s4            2.2870969772338867
       test/loss.s5            2.2868189811706543
       test/loss.s6            2.2945291996002197
  test/loss.shopping_mall      1.9366493225097656
test/loss.street_pedestrian     2.141679048538208
 test/loss.street_traffic      1.6279385089874268
      test/loss.tram           2.3628292083740234
    test/macro_avg_acc         0.18855400383472443
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────