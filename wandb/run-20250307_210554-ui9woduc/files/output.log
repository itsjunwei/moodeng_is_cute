GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
HPU available: False, using: 0 HPUs
You are using a CUDA device ('NVIDIA GeForce RTX 3060 Laptop GPU') that has Tensor Cores. To properly utilize them, you should set `torch.set_float32_matmul_precision('medium' | 'high')` which will trade-off precision for performance. For more details, read https://pytorch.org/docs/stable/generated/torch.set_float32_matmul_precision.html#torch.set_float32_matmul_precision
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Loading `train_dataloader` to estimate number of stepping batches.
C:\Users\fenel\anaconda3\envs\d24_t1\lib\site-packages\pytorch_lightning\trainer\connectors\data_connector.py:424: The 'train_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=15` in the `DataLoader` to improve performance.
C:\Users\fenel\anaconda3\envs\d24_t1\lib\site-packages\pytorch_lightning\loops\fit_loop.py:298: The number of training batches (28) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.
  | Name        | Type       | Params | Mode
---------------------------------------------------
0 | mel         | Sequential | 0      | train
1 | mel_augment | Sequential | 0      | train
2 | model       | Network    | 185 K  | train
3 | classifier  | Sequential | 2.7 K  | train
---------------------------------------------------
188 K     Trainable params
0         Non-trainable params
188 K     Total params
0.754     Total estimated model params size (MB)
137       Modules in train mode
0         Modules in eval mode
C:\Users\fenel\anaconda3\envs\d24_t1\lib\site-packages\pytorch_lightning\trainer\connectors\data_connector.py:424: The 'val_dataloader' does not have many workers which may be a bottleneck. Consider increasing the value of the `num_workers` argument` to `num_workers=15` in the `DataLoader` to improve performance.










Epoch 0: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:21<00:00,  1.32it/s, v_num=oduc]
































































































Epoch 1: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:48<00:00,  0.57it/s, v_num=oduc]





















































































































Epoch 2: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:49<00:00,  0.57it/s, v_num=oduc]





















































































































Epoch 3: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:50<00:00,  0.55it/s, v_num=oduc]



















































































































Epoch 4: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:50<00:00,  0.56it/s, v_num=oduc]























































































































Epoch 5: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:53<00:00,  0.52it/s, v_num=oduc]
























































































































Epoch 6: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:49<00:00,  0.57it/s, v_num=oduc]



















































































































Epoch 7: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:49<00:00,  0.57it/s, v_num=oduc]




















































































































Epoch 8: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:49<00:00,  0.57it/s, v_num=oduc]


















































































































Epoch 9: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:49<00:00,  0.57it/s, v_num=oduc]


















































































































Epoch 10: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:49<00:00,  0.57it/s, v_num=oduc]




















































































































Epoch 11: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:53<00:00,  0.52it/s, v_num=oduc]

































































































































Epoch 12: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [01:04<00:00,  0.43it/s, v_num=oduc]







































































































































Epoch 13: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [01:01<00:00,  0.46it/s, v_num=oduc]





































































































































Epoch 14: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [01:00<00:00,  0.46it/s, v_num=oduc]






































































































































Epoch 15: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [01:00<00:00,  0.46it/s, v_num=oduc]




































































































































Epoch 16: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [01:00<00:00,  0.46it/s, v_num=oduc]








































































































































Epoch 17: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [00:58<00:00,  0.48it/s, v_num=oduc]






































































































































Epoch 18: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [01:00<00:00,  0.46it/s, v_num=oduc]







































































































































Epoch 19: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 28/28 [01:00<00:00,  0.46it/s, v_num=oduc]








































































































Validation DataLoader 0:  99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉ | 115/116 [03:29<00:01,  0.55it/s]
`Trainer.fit` stopped: `max_epochs=20` reached.
Restoring states from the checkpoint path at C:\Users\fenel\Documents\dcase2024_task1_baseline\DCASE24_Task1\ui9woduc\checkpoints\last.ckpt
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
Loaded model weights from the checkpoint at C:\Users\fenel\Documents\dcase2024_task1_baseline\DCASE24_Task1\ui9woduc\checkpoints\last.ckpt





















Testing DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 116/116 [00:42<00:00,  2.71it/s]Test epoch ended; computing metrics...
Testing DataLoader 0: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 116/116 [00:42<00:00,  2.70it/s]
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
        Test metric               DataLoader 0
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────
         test/acc              0.2915431261062622
        test/acc.a             0.4151515066623688
     test/acc.airport          0.22770270705223083
        test/acc.b             0.33252280950546265
       test/acc.bus            0.4377104341983795
        test/acc.c             0.41063830256462097
      test/acc.metro           0.44983166456222534
  test/acc.metro_station       0.20033669471740723
       test/acc.park           0.5373737215995789
  test/acc.public_square       0.0309764314442873
       test/acc.real            0.38613361120224
        test/acc.s1            0.24909090995788574
        test/acc.s2            0.21909090876579285
        test/acc.s3            0.24454545974731445
        test/acc.s4            0.24848484992980957
        test/acc.s5            0.2736363708972931
        test/acc.s6            0.23121212422847748
       test/acc.seen           0.23757575452327728
  test/acc.shopping_mall       0.34983164072036743
test/acc.street_pedestrian     0.3441077470779419
  test/acc.street_traffic      0.14915825426578522
       test/acc.tram           0.18783783912658691
      test/acc.unseen          0.25111111998558044
        test/cnt.a                   3300.0
     test/cnt.airport                2960.0
        test/cnt.b                   3290.0
       test/cnt.bus                  2970.0
        test/cnt.c                   3290.0
      test/cnt.metro                 2970.0
  test/cnt.metro_station             2970.0
       test/cnt.park                 2970.0
  test/cnt.public_square             2970.0
        test/cnt.s1                  3300.0
        test/cnt.s2                  3300.0
        test/cnt.s3                  3300.0
        test/cnt.s4                  3300.0
        test/cnt.s5                  3300.0
        test/cnt.s6                  3300.0
  test/cnt.shopping_mall             2970.0
test/cnt.street_pedestrian           2970.0
  test/cnt.street_traffic            2970.0
       test/cnt.tram                 2960.0
      test/count.real                9880.0
      test/count.seen                9900.0
     test/count.unseen               9900.0
      test/lloss.real          1.6426877975463867
      test/lloss.seen          2.1290783882141113
     test/lloss.unseen         2.1750619411468506
         test/loss             1.9823395013809204
        test/loss.a            1.5815266370773315
     test/loss.airport         1.7244048118591309
        test/loss.b            1.7780009508132935
       test/loss.bus            1.415705919265747
        test/loss.c            1.5687217712402344
      test/loss.metro          1.3470163345336914
  test/loss.metro_station      1.9191898107528687
      test/loss.park           1.7490426301956177
  test/loss.public_square      2.8788604736328125
       test/loss.s1            2.1002211570739746
       test/loss.s2             2.173065423965454
       test/loss.s3            2.1139485836029053
       test/loss.s4            2.2272896766662598
       test/loss.s5             2.078930616378784
       test/loss.s6            2.2189650535583496
  test/loss.shopping_mall      2.0088536739349365
test/loss.street_pedestrian     2.403592586517334
 test/loss.street_traffic       2.652034044265747
      test/loss.tram           1.7246108055114746
    test/macro_avg_acc         0.2914867103099823
────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────